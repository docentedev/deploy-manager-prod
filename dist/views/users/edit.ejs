<%- include('../partials/header.ejs', { title: 'Deploy Manager' }) %>

  <div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h2">Edit User</h1>
      <a href="/users" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Back to Users
      </a>
    </div>

    <% if (error) { %>
      <div class="alert alert-danger" role="alert">
        <%= error %>
      </div>
      <% } %>

        <div class="card bg-dark border-secondary">
          <div class="card-body">
            <form action="/users/<%= user.id %>" method="POST">
              <input type="hidden" name="_method" value="PUT">

              <div class="mb-3">
                <label for="username" class="form-label">Username:</label>
                <input type="text" class="form-control bg-dark text-light border-secondary" id="username"
                  name="username" value="<%= user.username %>" required>
              </div>

              <div class="mb-3">
                <label for="email" class="form-label">Email:</label>
                <input type="email" class="form-control bg-dark text-light border-secondary" id="email" name="email"
                  value="<%= user.email %>" required>
              </div>

              <div class="mb-3">
                <label for="role" class="form-label">Role:</label>
                <select class="form-select bg-dark text-light border-secondary" id="role" name="role" required>
                  <option value="user" <%=user.role==='user' ? 'selected' : '' %>>User</option>
                  <option value="developer" <%=user.role==='developer' ? 'selected' : '' %>>Developer</option>
                  <option value="admin" <%=user.role==='admin' ? 'selected' : '' %>>Administrator</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="password" class="form-label">New Password (leave empty to keep current):</label>
                <input type="password" class="form-control bg-dark text-light border-secondary" id="password"
                  name="password">
                <div class="form-text text-muted">Minimum 8 characters. Only fill this if you want to change the
                  password.</div>
              </div>

              <div class="mb-3">
                <label for="confirmPassword" class="form-label">Confirm New Password:</label>
                <input type="password" class="form-control bg-dark text-light border-secondary" id="confirmPassword"
                  name="confirmPassword">
              </div>

              <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="active" name="active" <%=user.active ? 'checked'
                  : '' %>>
                <label class="form-check-label" for="active">Active Account</label>
              </div>

              <div class="d-flex justify-content-between">
                <a href="/users/<%= user.id %>" class="btn btn-outline-secondary">
                  <i class="bi bi-x-circle"></i> Cancel
                </a>
                <button type="submit" class="btn btn-primary">
                  <i class="bi bi-save"></i> Save Changes
                </button>
              </div>
            </form>
          </div>
        </div>
  </div>

  <%- include('../partials/footer.ejs') %>